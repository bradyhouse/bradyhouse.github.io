import{u as V,b as L}from"./vue-router-HjeD-AfS.js";import{h as P}from"./html2canvas-BfYXEYrK.js";import{l as h}from"./lodash-TVC-EY0t.js";import{_ as M}from"./index-DG5PObGV.js";import{o,f as c,r as m,D as k,q as F,F as x,j as R,l as j,g as t,v as w,y as D,t as y,u as Z,x as T,z as J,A as C,E as A}from"./@vue-D4AyGaXM.js";import"./pinia-ZECr7jlV.js";/* empty css                   */const U={},X={src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxlbGxpcHNlIGN4PSIxMiIgY3k9IjUiIGZpbGw9ImN1cnJlbnRDb2xvciIgcng9IjQiIHJ5PSI0Ij48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnNCb3VuY2luZ0JhbGwwIiBmaWxsPSJmcmVlemUiIGF0dHJpYnV0ZU5hbWU9ImN5IiBiZWdpbj0iMDtzdmdTcGlubmVyc0JvdW5jaW5nQmFsbDIuZW5kIiBjYWxjTW9kZT0ic3BsaW5lIiBkdXI9IjAuMzc1cyIga2V5U3BsaW5lcz0iLjMzLDAsLjY2LC4zMyIgdmFsdWVzPSI1OzIwIi8+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0icngiIGJlZ2luPSJzdmdTcGlubmVyc0JvdW5jaW5nQmFsbDAuZW5kIiBjYWxjTW9kZT0ic3BsaW5lIiBkdXI9IjAuMDVzIiBrZXlTcGxpbmVzPSIuMzMsMCwuNjYsLjMzOy4zMywuNjYsLjY2LDEiIHZhbHVlcz0iNDs0Ljg7NCIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InJ5IiBiZWdpbj0ic3ZnU3Bpbm5lcnNCb3VuY2luZ0JhbGwwLmVuZCIgY2FsY01vZGU9InNwbGluZSIgZHVyPSIwLjA1cyIga2V5U3BsaW5lcz0iLjMzLDAsLjY2LC4zMzsuMzMsLjY2LC42NiwxIiB2YWx1ZXM9IjQ7Mzs0Ii8+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzQm91bmNpbmdCYWxsMSIgYXR0cmlidXRlTmFtZT0iY3kiIGJlZ2luPSJzdmdTcGlubmVyc0JvdW5jaW5nQmFsbDAuZW5kIiBjYWxjTW9kZT0ic3BsaW5lIiBkdXI9IjAuMDI1cyIga2V5U3BsaW5lcz0iLjMzLDAsLjY2LC4zMyIgdmFsdWVzPSIyMDsyMC41Ii8+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzQm91bmNpbmdCYWxsMiIgYXR0cmlidXRlTmFtZT0iY3kiIGJlZ2luPSJzdmdTcGlubmVyc0JvdW5jaW5nQmFsbDEuZW5kIiBjYWxjTW9kZT0ic3BsaW5lIiBkdXI9IjAuNHMiIGtleVNwbGluZXM9Ii4zMywuNjYsLjY2LDEiIHZhbHVlcz0iMjAuNTs1Ii8+PC9lbGxpcHNlPjwvc3ZnPg=="};function H(s,b){return o(),c("img",X)}const Q=M(U,[["render",H]]),z=s=>(J("data-v-be9c40bc"),s=s(),C(),s),E={key:0,class:"dashboards"},$={style:{"text-align":"center","padding-top":"10px"}},q={key:1},O=z(()=>t("h3",null,"Generting previews ...",-1)),K={style:{padding:"10px"}},ee={style:{width:"100%"}},te={style:{border:"dotted 2px gray",width:"60%"}},ae=z(()=>t("thead",{style:{padding:"10px"}},[t("th",{style:{border:"solid 1px gainsboro","text-align":"left","vertical-align":"middle",padding:"10px"}}," I F R A M E "),t("th",{style:{border:"solid 1px gainsboro","text-align":"right","vertical-align":"middle",padding:"10px"}}," P R E V I E W ")],-1)),ne={style:{"vertical-align":"top","text-align":"left"}},ie=["src"],se={style:{"vertical-align":"top","text-align":"right"}},le=["src"],oe={__name:"FiddleView",setup(s){const b=V(),f=window.location.pathname,S=b.path,B=f.replace(S,""),N=L().getRoutes().filter(e=>e.name!==void 0&&e.name!=="404"&&e.name!=="fiddle"),g=[],p=[],l=m(null),Y=m(null),I=m(null),d=m(!1);let r=null,u=null;const G=h.debounce(async e=>{if(e){const n=document.getElementById("targetPage"),i=await P(n.contentWindow.document.body),a=i.getContext("2d");a.filter="blur(1.2px) grayscale(100%) contrast(200%)",a.drawImage(i,0,0,i.width,i.height);debugger;const _=i.toDataURL("image/png");I.value=_,g.push({name:String(u.name),preview:String(_),path:String(u.path)})}},2e3);N.forEach(e=>{const n=localStorage.getItem(e.name+"-preview");if(n)g.push({name:String(e.name),preview:String(n),path:String(e.path)});else{debugger;p.push({name:String(e.name),preview:null,path:String(e.path)})}});const W=h.debounce(()=>{if(p.length){const e=p.pop();d.value=!0,e.name?(u=e,r=e.name+"-preview",l.value="http://"+window.location.host+"/"+B+e.name,I.value=null,console.log(r,l.value)):(console.log("targetRoute",e),u=null,r=null,l.value=null)}else d.value=!1},1e3);k(()=>{W()});const v=h.debounce(async e=>{await G(r),setTimeout(()=>{W()},5e3)},500);return(e,n)=>{const i=F("router-link");return o(),c(x,null,[d.value?j("",!0):(o(),c("div",E,[(o(),c(x,null,R(g,a=>w(i,{key:a.path,to:a.path},{default:T(()=>[t("div",{class:"dashboard square",style:A({backgroundImage:`url(${a.preview})`,backgroundRepeat:"no-repeat",backgroundSize:"100% auto",border:"dashed 1px gray"})},null,4),t("h4",$,y(a.name),1)]),_:2},1032,["to"])),64))])),d.value?(o(),c("div",q,[t("p",null,[w(Q),D(" Â "),O]),t("div",K,[t("div",ee,[t("h5",null,y(l.value),1)]),t("table",te,[ae,t("tbody",null,[t("tr",null,[t("td",ne,[t("iframe",{id:"targetPage",ref_key:"elFrame",ref:Y,style:{height:"400px",width:"600px"},onLoad:n[0]||(n[0]=(...a)=>Z(v)&&Z(v)(...a)),src:l.value},null,40,ie)]),t("td",se,[t("img",{src:I.value,style:{width:"200px"}},null,8,le)])])])])])])):j("",!0)],64)}}},he=M(oe,[["__scopeId","data-v-be9c40bc"]]);export{he as default};
